2025-09-27 23:40:13,183 - my_logger - INFO - 

2025-09-27 23:40:13,183 - my_logger - INFO - >>>>>>> START LOGGING <<<<<<<<
2025-09-28 01:16:44,022 - my_logger - ERROR - ffocp_eq_n2_lr0.1_seed1: An error occurred: Solver 'GUROBI' failed. Try another solver, or solve with verbose=True for more information.
Traceback (most recent call last):
  File "/nethome/sho73/bilevel_layer_project/bilevel-layer_package/sudoku/main_sudoku.py", line 215, in <module>
    train_test_loop(args, experiment_dir, n=n)
  File "/nethome/sho73/bilevel_layer_project/bilevel-layer_package/sudoku/main_sudoku.py", line 118, in train_test_loop
    loss.backward()
  File "/nethome/sho73/miniconda3/envs/bilevel/lib/python3.10/site-packages/torch/_tensor.py", line 581, in backward
    torch.autograd.backward(
  File "/nethome/sho73/miniconda3/envs/bilevel/lib/python3.10/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/nethome/sho73/miniconda3/envs/bilevel/lib/python3.10/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
  File "/nethome/sho73/miniconda3/envs/bilevel/lib/python3.10/site-packages/torch/autograd/function.py", line 307, in apply
    return user_fn(self, *args)
  File "/nethome/sho73/bilevel_layer_project/bilevel-layer_package/ffocp_eq.py", line 336, in backward
    problem.solve(solver=cp.GUROBI)
  File "/nethome/sho73/miniconda3/envs/bilevel/lib/python3.10/site-packages/cvxpy/problems/problem.py", line 609, in solve
    return solve_func(self, *args, **kwargs)
  File "/nethome/sho73/miniconda3/envs/bilevel/lib/python3.10/site-packages/cvxpy/problems/problem.py", line 1222, in _solve
    self.unpack_results(solution, solving_chain, inverse_data)
  File "/nethome/sho73/miniconda3/envs/bilevel/lib/python3.10/site-packages/cvxpy/problems/problem.py", line 1547, in unpack_results
    raise error.SolverError(
cvxpy.error.SolverError: Solver 'GUROBI' failed. Try another solver, or solve with verbose=True for more information.
2025-09-28 23:51:30,346 - my_logger - INFO - 

2025-09-28 23:51:30,347 - my_logger - INFO - >>>>>>> START LOGGING <<<<<<<<
2025-09-29 00:02:11,972 - my_logger - INFO - 

2025-09-29 00:02:11,973 - my_logger - INFO - >>>>>>> START LOGGING <<<<<<<<
2025-09-29 00:02:15,618 - my_logger - ERROR - ffocp_eq_n2_lr0.1_seed1: An error occurred: Two or more parameters are on different devices. Expected parameter 1 to be on device cpu but got device cuda:0.
Traceback (most recent call last):
  File "/nethome/zzhao628/ffo-bilevel/sudoku/main_sudoku.py", line 216, in <module>
    train_test_loop(args, experiment_dir, n=n)
  File "/nethome/zzhao628/ffo-bilevel/sudoku/main_sudoku.py", line 113, in train_test_loop
    pred = model(x)
  File "/nethome/zzhao628/anaconda3/envs/bilevel/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/nethome/zzhao628/anaconda3/envs/bilevel/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/nethome/zzhao628/ffo-bilevel/sudoku/models_sudoku.py", line 220, in forward
    sol, = self.optlayer(*params_batched)
  File "/nethome/zzhao628/anaconda3/envs/bilevel/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/nethome/zzhao628/anaconda3/envs/bilevel/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/nethome/zzhao628/ffo-bilevel/ffocp_eq.py", line 96, in forward
    sol = f(*params)
  File "/nethome/zzhao628/anaconda3/envs/bilevel/lib/python3.10/site-packages/torch/autograd/function.py", line 575, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/nethome/zzhao628/ffo-bilevel/ffocp_eq.py", line 137, in forward
    raise ValueError(
ValueError: Two or more parameters are on different devices. Expected parameter 1 to be on device cpu but got device cuda:0.
2025-09-29 00:02:46,634 - my_logger - INFO - 

2025-09-29 00:02:46,634 - my_logger - INFO - >>>>>>> START LOGGING <<<<<<<<
2025-09-29 00:07:02,621 - my_logger - INFO - 

2025-09-29 00:07:02,622 - my_logger - INFO - >>>>>>> START LOGGING <<<<<<<<
2025-09-29 00:10:29,443 - my_logger - INFO - 

2025-09-29 00:10:29,444 - my_logger - INFO - >>>>>>> START LOGGING <<<<<<<<
2025-09-29 00:28:29,953 - my_logger - INFO - 

2025-09-29 00:28:29,954 - my_logger - INFO - >>>>>>> START LOGGING <<<<<<<<
2025-09-29 00:28:32,111 - my_logger - ERROR - ffocp_eq_n2_lr0.1_seed1: An error occurred: 
Traceback (most recent call last):
  File "/nethome/zzhao628/ffo-bilevel/sudoku/main_sudoku.py", line 217, in <module>
    train_test_loop(args, experiment_dir, n=n)
  File "/nethome/zzhao628/ffo-bilevel/sudoku/main_sudoku.py", line 65, in train_test_loop
    model = SingleOptLayerSudoku(n, learnable_parts=["eq"], layer_type=method, Qpenalty=0.1, alpha=1000)
  File "/nethome/zzhao628/ffo-bilevel/sudoku/models_sudoku.py", line 163, in __init__
    problem, objective, ineq_functions, eq_functions, params, variables = setup_cvx_qp_problem(opt_var_dim=self.y_dim, num_ineq=self.num_ineq, num_eq=self.num_eq)
  File "/nethome/zzhao628/ffo-bilevel/sudoku/utils_sudoku.py", line 47, in setup_cvx_qp_problem
    assert problem.is_dpp()
AssertionError
2025-09-29 00:43:49,573 - my_logger - INFO - 

2025-09-29 00:43:49,574 - my_logger - INFO - >>>>>>> START LOGGING <<<<<<<<
